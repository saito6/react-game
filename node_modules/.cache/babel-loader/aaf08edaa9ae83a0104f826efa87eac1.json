{"ast":null,"code":"var _jsxFileName = \"/Users/saito/Documents/GitHub/react-game/src/components/App.js\";\nimport React, { useState, useEffect } from 'react';\nimport '../css/reset.css';\nimport '../css/index.css';\nimport Header from './Header';\nimport Game from './Game';\nimport Info from './Info';\nimport Popup from './Popup';\nimport Start from './Start';\nimport Result from './Result';\nimport AppContext from '../contexts/AppContext';\nimport { cardSetf } from '../function/cardSet';\nimport { answerf } from '../function/answer'; // ========================================\n\nexport var timerArray = new Array(); //外に出すことによってstateを即時反映できる\n\nconst App = () => {\n  var cardSet = cardSetf(); // TODO: カードを推すたびに呼び出されちゃってる\n\n  const initialState = {\n    cardSet: cardSet,\n    //cardの並び\n    answer: answerf(cardSet),\n    //答えの組合せ\n    userChoice: [null, null],\n    //userの選択\n    floor: 1\n  };\n  const [state, setState] = useState(initialState);\n  const [judge, setJudge] = useState(false); //正解か不正解状態\n\n  const [open, setOpen] = useState(false); //表示、非表示\n\n  const [timer, setTimer] = useState(20);\n  const [start, setStart] = useState(0); //0の時start-modal表示、1の時ゲーム中、2の時result画面表示\n\n  const [result, setResult] = useState(2);\n  let count;\n\n  const timerf = () => {\n    console.log('配列数:' + timerArray.length);\n    console.log('timer' + timer);\n    count = timer;\n    const promise = new Promise(resolve => {\n      timerArray.push(setInterval(() => {\n        console.log('配列数:' + timerArray.length);\n        count--;\n        setTimer(count);\n        console.log(count, timer);\n\n        if (count === 0) {\n          resolve();\n          console.log('配列数:' + timerArray.length);\n          const reset = setTimeout(() => {\n            //1秒後に時間切れでリセット\n            if (state.floor >= 2) {\n              setStart(2);\n            }\n\n            setTimer(20);\n            console.log('timer:' + timer);\n            setState({\n              cardSet: cardSet,\n              answer: answerf(cardSet),\n              userChoice: [null, null],\n              floor: 1\n            });\n            setOpen(true);\n            setTimeout(setOpen, 1000, false);\n          }, 1000);\n        }\n      }, 1000));\n    });\n    promise.then(() => {\n      console.log('clear'); //タイマーを止める\n\n      clearInterval(timerArray.shift());\n    });\n  };\n\n  useEffect( //floorを参照して変更があったときに正解不正解を識別\n  () => {\n    if (state.floor == 1) {\n      setJudge(false);\n    } else {\n      setJudge(true);\n    }\n  }, [state.floor]);\n  useEffect( //timer\n  () => {\n    if (start === 1) {\n      if (timer === 20) {\n        console.log('timerf:' + timer);\n        timerf();\n      }\n    }\n  }, [timer, start]);\n  return /*#__PURE__*/React.createElement(AppContext.Provider, {\n    value: {\n      state,\n      setState,\n      open,\n      setOpen,\n      judge,\n      timer,\n      setTimer,\n      start,\n      setStart\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Start, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Result, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"game\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Game, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Info, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Popup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/saito/Documents/GitHub/react-game/src/components/App.js"],"names":["React","useState","useEffect","Header","Game","Info","Popup","Start","Result","AppContext","cardSetf","answerf","timerArray","Array","App","cardSet","initialState","answer","userChoice","floor","state","setState","judge","setJudge","open","setOpen","timer","setTimer","start","setStart","result","setResult","count","timerf","console","log","length","promise","Promise","resolve","push","setInterval","reset","setTimeout","then","clearInterval","shift"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\n\nimport '../css/reset.css';\nimport '../css/index.css';\n\nimport Header from './Header';\nimport Game from './Game';\nimport Info from './Info';\nimport Popup from './Popup';\nimport Start from './Start';\nimport Result from './Result';\nimport AppContext from '../contexts/AppContext';\n\nimport {cardSetf} from '../function/cardSet';\nimport {answerf} from '../function/answer';\n\n// ========================================\n\nexport var timerArray = new Array();//外に出すことによってstateを即時反映できる\n\nconst App = () => {\n  var cardSet = cardSetf();// TODO: カードを推すたびに呼び出されちゃってる\n  const initialState = {\n    cardSet:cardSet,//cardの並び\n    answer:answerf(cardSet),//答えの組合せ\n    userChoice:[null,null],//userの選択\n    floor:1\n  }\nconst [state,setState] = useState(initialState);\nconst [judge,setJudge] = useState(false);//正解か不正解状態\nconst [open,setOpen] = useState(false);//表示、非表示\nconst [timer,setTimer] = useState(20);\nconst [start,setStart] = useState(0);//0の時start-modal表示、1の時ゲーム中、2の時result画面表示\nconst [result,setResult] = useState(2);\n\nlet count;\nconst timerf = () => {\n  console.log('配列数:'+timerArray.length);\n  console.log('timer'+timer);\n  count = timer;\n  const promise = new Promise((resolve) => {\n    timerArray.push(setInterval(() => {\n      console.log('配列数:'+timerArray.length);\n      count--;\n      setTimer(count);\n      console.log(count,timer);\n      if(count === 0) {\n        resolve();\n        console.log('配列数:'+timerArray.length);\n        const reset = setTimeout(() => {//1秒後に時間切れでリセット\n          if(state.floor >= 2){\n            setStart(2);\n          }\n          setTimer(20);\n          console.log('timer:'+timer);\n          setState({\n            cardSet:cardSet,\n            answer:answerf(cardSet),\n            userChoice:[null,null],\n            floor:1\n          });\n          setOpen(true);\n          setTimeout(setOpen,1000,false);\n        }, 1000);\n      }\n    }, 1000));\n  });\n  promise.then(() => {\n    console.log('clear');\n    //タイマーを止める\n    clearInterval(timerArray.shift());\n  });\n}\n  useEffect(//floorを参照して変更があったときに正解不正解を識別\n    () => {\n      if(state.floor == 1){\n        setJudge(false);\n      }\n      else{\n        setJudge(true);\n      }\n    },\n    [state.floor]\n  );\n\n  useEffect(//timer\n    () => {\n      if(start === 1) {\n        if(timer === 20){\n          console.log('timerf:'+timer);\n          timerf();\n        }\n      }\n    },[timer,start]\n  );\n\n  return(\n    <AppContext.Provider value={{state,setState,open,setOpen,judge,timer,setTimer,start,setStart}}>\n    <Start />\n    <Result />\n    <Header />\n    <div className=\"game\">\n      <div className=\"inner\">\n        <Game />\n        <Info />\n        <Popup />\n      </div>\n    </div>\n    </AppContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}